<!DOCTYPE html>
<html>
<head>
  <title>Seki - Player demo</title>
  <meta charset="utf-8">
  <meta name="author" content="Adam Reis">
  <link rel="stylesheet" type="text/css" media="screen" href="../src/css/seki.css">
  <link rel="stylesheet" type="text/css" media="screen" href="demo.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body lang="en">
<div class="main" id="app">
  <div class="left">
    <div id="player">
      <div id="board"></div>
    </div>
  </div>
  <div class="right">
    <h2>Load</h2>
    <button id="loadBlank">Blank</button>
    <button id="loadJgf">JGF</button>
    <button id="loadSgf">SGF</button>
    <button id="loadGib">GIB</button>

    <h2>Mode</h2>
    <button class="btnSwitchMode icon" mode="static" title="View only">
      <span class="material-symbols-outlined">visibility_lock</span>
    </button>
    <button class="btnSwitchMode icon" mode="replay" title="Replay">
      <span class="material-symbols-outlined">fiber_smart_record</span>
    </button>
    <button class="btnSwitchMode icon" icon mode="edit" title="Edit">
      <span class="material-symbols-outlined">edit</span>
    </button>
    <button class="btnSwitchMode icon" mode="solve" title="Solve">
      <span class="material-symbols-outlined">lightbulb</span>
    </button>

    <div id="editTools">
      <h2>Markup</h2>
      <button class="btnUseEditingTool icon" tool="circle" class="icon">
        <span class="material-symbols-outlined">circle</span>
      </button>
      <button class="btnUseEditingTool icon" tool="triangle" class="icon">
        <span class="material-symbols-outlined">change_history</span>
      </button>
      <button class="btnUseEditingTool icon" tool="square" class="icon">
        <span class="material-symbols-outlined">square</span>
      </button>
      <button class="btnUseEditingTool icon" tool="diamond" class="icon">
        <span class="material-symbols-outlined">diamond</span>
      </button>
      <button class="btnUseEditingTool icon" tool="mark" class="icon">
        <span class="material-symbols-outlined">close</span>
      </button>
      <br>
      <button class="btnUseEditingTool icon" tool="letter" class="icon">
        <span class="material-symbols-outlined">abc</span>
      </button>
      <button class="btnUseEditingTool icon" tool="number" class="icon">
        <span class="material-symbols-outlined">123</span>
      </button>
      <button class="btnUseEditingTool icon" tool="happy" class="icon">
        <span class="material-symbols-outlined">sentiment_satisfied</span>
      </button>
      <button class="btnUseEditingTool icon" tool="sad" class="icon">
        <span class="material-symbols-outlined">sentiment_dissatisfied</span>
      </button>
      <button class="btnUseEditingTool icon" tool="clear" class="icon" title="Clear">
        <span class="material-symbols-outlined">ink_eraser</span>
      </button>

      <h2>Setup</h2>
      <button class="btnUseEditingTool icon" tool="black" class="icon" title="Black stone">
        <span class="material-symbols-outlined">trip_origin</span>
      </button>
      <button class="btnUseEditingTool icon" tool="white" class="icon" title="White stone">
        <span class="material-symbols-outlined">fiber_manual_record</span>
      </button>
      <button class="btnUseEditingTool icon" tool="clear" class="icon" title="Clear">
        <span class="material-symbols-outlined">ink_eraser</span>
      </button>
    </div>

    <div id="replayTools">
      <h2>Navigation</h2>

      <button class="icon" id="firstMove" title="First move">
        <span class="material-symbols-outlined">line_start_arrow</span>
      </button>
      <button class="icon" id="skipBack" title="Skip back 10 moves">
        <span class="material-symbols-outlined">fast_rewind</span>
      </button>
      <button class="icon" id="prevMove" title="Previous move">
        <span class="material-symbols-outlined">skip_previous</span>
      </button>

      <button class="icon" id="startAutoPlay" title="Start auto play">
        <span class="material-symbols-outlined">play_arrow</span>
      </button>
      <button class="icon" id="stopAutoPlay" title="Stop auto play">
        <span class="material-symbols-outlined">stop</span>
      </button>

      <button class="icon" id="nextMove" title="Next move">
        <span class="material-symbols-outlined">skip_next</span>
      </button>
      <button class="icon" id="skipForward" title="Skip forward 10 moves">
        <span class="material-symbols-outlined">fast_forward</span>
      </button>
      <button class="icon" id="lastMove" title="Last move">
        <span class="material-symbols-outlined">line_end_arrow</span>
      </button>

      <br>
      <button class="icon" id="prevVariation" title="Previous variation">
        <span class="material-symbols-outlined">expand_less</span>
      </button>
      <button class="icon" id="nextVariation" title="Next variation">
        <span class="material-symbols-outlined">expand_more</span>
      </button>
      <button class="icon" id="prevFork" title="Previous fork">
        <span class="material-symbols-outlined">fork_left</span>
      </button>
      <button class="icon" id="nextFork" title="Next fork">
        <span class="material-symbols-outlined">fork_right</span>
      </button>
      <button class="icon" id="prevComment" title="Previous comment">
        <span class="material-symbols-outlined">comment</span>
      </button>
      <button class="icon" id="nextComment" title="Next comment">
        <span class="material-symbols-outlined">chat</span>
      </button>
    </div>

    <h2>Other</h2>
    <button id="toggleCoordinates">Toggle coordinates</button>
    <button id="toggleNextMove">Toggle next move</button>
    <button id="toggleVariations">Toggle variations</button>
    <button id="toggleSwapColors">Swap colors</button>
  </info>
</div>
<script type="module">
import Board from '../src/classes/board.js'
import Player from '../src/classes/player.js'
import {setDebug} from '../src/helpers/util.js'
import {playerModes, editingTools} from '../src/constants/player.js'
import {onClick, findByQuery, toggleHidden} from './demo.js'

//Test data
import {jgf} from './data/jgf.js'
import {gib} from './data/gib.js'
import {sgf} from './data/sgf.js'

//Set debug mode
setDebug(true)

//Find player element and instantiate player
const playerElement = document.getElementById('player')
const player = new Player()

//Bootstrap player and load JGF file
player.bootstrap(playerElement)
player.load(jgf)

//Data loading
onClick('#loadJgf', () => {
  player.load(jgf)
  player.switchMode(playerModes.REPLAY)
})
onClick('#loadSgf', () => {
  player.load(sgf)
  player.switchMode(playerModes.REPLAY)
})
onClick('#loadGib', () => {
  player.load(gib)
  player.switchMode(playerModes.REPLAY)
})
onClick('#loadBlank', () => {
  player.reset()
  player.switchMode(playerModes.PLAY)
})

//Toggles
onClick('#toggleNextMove', () => player.toggleConfig('showNextMove'))
onClick('#toggleVariations', () => player.toggleConfig('showVariations'))
onClick('#toggleCoordinates', () => player.board.toggleCoordinates())
onClick('#toggleSwapColors', () => player.board.toggleSwapColors())

//Navigation
onClick('#firstMove', () => player.first())
onClick('#skipBack', () => player.skipBack())
onClick('#prevMove', () => player.previous())
onClick('#nextMove', () => player.next())
onClick('#skipForward', () => player.skipForward())
onClick('#lastMove', () => player.last())
onClick('#prevFork', () => player.previousFork())
onClick('#nextFork', () => player.nextFork())
onClick('#prevComment', () => player.previousComment())
onClick('#nextComment', () => player.nextComment())
onClick('#prevVariation', () => player.selectPreviousVariation())
onClick('#nextVariation', () => player.selectNextVariation())

//Auto play
onClick('#startAutoPlay', () => {
  player.startAutoPlay()
  toggleHidden('#startAutoPlay', true)
  toggleHidden('#stopAutoPlay', false)
})
onClick('#stopAutoPlay', () => {
  player.stopAutoPlay()
  toggleHidden('#stopAutoPlay', true)
  toggleHidden('#startAutoPlay', false)
})

//Mode switching
onClick('.btnSwitchMode', btn => {
  const mode = btn.getAttribute('mode')
  player.switchMode(mode)
})

//Editing tool selection
onClick('.btnUseEditingTool', btn => {
  const tool = btn.getAttribute('tool')
  player.useEditingTool(tool)
})

//Handler for mode changes
const onModeChange = () => {
  const mode = player.getActiveMode()

  //Toggle mode buttons
  findByQuery('.btnSwitchMode')
    .forEach(btn => btn.disabled = btn.getAttribute('mode') === mode)

  //Toggle tools
  toggleHidden('#replayTools', mode !== playerModes.REPLAY)
  toggleHidden('#editTools', mode !== playerModes.EDIT)
}

//Event handlers
player.on('modeChange', onModeChange)

//Init
onModeChange()
toggleHidden('#stopAutoPlay', true)
</script>
</body>
</html>
