<!DOCTYPE html>
<html>
<head>
  <title>Seki - Player demo</title>
  <meta charset="utf-8">
  <meta name="author" content="Adam Reis">
  <link rel="stylesheet" type="text/css" media="screen" href="../src/css/seki.css">
  <link rel="stylesheet" type="text/css" media="screen" href="demo.css">
</head>
<body lang="en">
<div class="main" id="app">
  <div class="left">
    <div id="player">
      <div id="board"></div>
    </div>
  </div>
  <div class="right">
    <h2>Load data</h2>
    <button id="loadBlank">Blank board</button>
    <button id="loadJgf">Load JGF</button>
    <button id="loadSgf">Load SGF</button>
    <button id="loadGib">Load GIB</button>

    <h2>Switch mode</h2>
    <button id="switchModeNone">None</button>
    <button id="switchModeReplay">Replay</button>
    <button id="switchModePlay">Play</button>
    <button id="switchModeEdit">Edit</button>
    <button id="switchModeSolve">Solve</button>

    <div id="editTools">
      <h2>Markup</h2>
      <button id="switchMarkupToolCircle">Circle</button>
      <button id="switchMarkupToolTriangle">Triangle</button>
      <button id="switchMarkupToolSquare">Square</button>
      <button id="switchMarkupToolDiamond">Diamond</button>
      <button id="switchMarkupToolMark">Mark</button>
      <button id="switchMarkupToolLetter">Letter</button>
      <button id="switchMarkupToolNumber">Number</button>
      <button id="switchMarkupToolHappy">Happy</button>
      <button id="switchMarkupToolSad">Sad</button>
      <button id="switchMarkupToolClear">Clear</button>

      <h2>Setup</h2>
      <button id="switchToolMove">Move</button>
      <button id="switchSetupToolBlack">Black</button>
      <button id="switchSetupToolWhite">White</button>
      <button id="switchSetupToolClear">Clear</button>
    </div>

    <div id="replayTools">
      <h2>Auto play</h2>
      <button id="startAutoPlay">Start</button>
      <button id="stopAutoPlay">Stop</button>
    </div>

    <h2>Other</h2>
    <button id="toggleCoordinates">Toggle coordinates</button>
    <button id="toggleSwapColors">Swap colors</button>
  </info>
</div>
<script type="module">
  import Board from '../src/classes/board.js'
  import Player from '../src/classes/player.js'
  import {setDebug} from '../src/helpers/util.js'
  import {bindClickHandler, toggleVisibility} from '../src/helpers/dom.js'
  import {playerModes, playerTools, markupTools, setupTools} from '../src/constants/player.js'

  //Test data
  import {jgf} from './data/jgf.js'
  import {gib} from './data/gib.js'
  import {sgf} from './data/sgf.js'

  //Set debug mode
  setDebug(true)

  //Find player element
  const playerElement = document.getElementById('player')

  //Instantiate player
  const player = new Player()

  //Bootstrap player and load JGF file
  player.bootstrap(playerElement)
  player.load(jgf)

  //Data loading
  bindClickHandler('loadJgf', () => {
    player.load(jgf)
    player.switchMode(playerModes.REPLAY)
  })
  bindClickHandler('loadSgf', () => {
    player.load(sgf)
    player.switchMode(playerModes.REPLAY)
  })
  bindClickHandler('loadGib', () => {
    player.load(gib)
    player.switchMode(playerModes.REPLAY)
  })
  bindClickHandler('loadBlank', () => {
    player.reset()
    player.switchMode(playerModes.PLAY)
  })

  //Coordinates
  bindClickHandler('toggleCoordinates', () => player.board.toggleCoordinates())
  bindClickHandler('toggleSwapColors', () => player.board.toggleSwapColors())

  //Auto play
  bindClickHandler('startAutoPlay', () => player.startAutoPlay())
  bindClickHandler('stopAutoPlay', () => player.stopAutoPlay())

  //Mode switching
  bindClickHandler('switchModeNone', () => player.switchMode(playerModes.NONE))
  bindClickHandler('switchModeReplay', () => player.switchMode(playerModes.REPLAY))
  bindClickHandler('switchModePlay', () => player.switchMode(playerModes.PLAY))
  bindClickHandler('switchModeEdit', () => player.switchMode(playerModes.EDIT))
  bindClickHandler('switchModeSolve', () => player.switchMode(playerModes.SOLVE))

  //Markup tools
  bindClickHandler('switchMarkupToolCircle', () => {
    player.switchMarkupTool(markupTools.CIRCLE)
  })
  bindClickHandler('switchMarkupToolTriangle', () => {
    player.switchMarkupTool(markupTools.TRIANGLE)
  })
  bindClickHandler('switchMarkupToolSquare', () => {
    player.switchMarkupTool(markupTools.SQUARE)
  })
  bindClickHandler('switchMarkupToolDiamond', () => {
    player.switchMarkupTool(markupTools.DIAMOND)
  })
  bindClickHandler('switchMarkupToolMark', () => {
    player.switchMarkupTool(markupTools.MARK)
  })
  bindClickHandler('switchMarkupToolLetter', () => {
    player.switchMarkupTool(markupTools.LETTER)
  })
  bindClickHandler('switchMarkupToolNumber', () => {
    player.switchMarkupTool(markupTools.NUMBER)
  })
  bindClickHandler('switchMarkupToolHappy', () => {
    player.switchMarkupTool(markupTools.HAPPY)
  })
  bindClickHandler('switchMarkupToolSad', () => {
    player.switchMarkupTool(markupTools.SAD)
  })
  bindClickHandler('switchMarkupToolClear', () => {
    player.switchMarkupTool(markupTools.CLEAR)
  })

  //Setup tools
  bindClickHandler('switchToolMove', () => {
    player.switchTool(playerTools.MOVE)
  })
  bindClickHandler('switchSetupToolBlack', () => {
    player.switchSetupTool(setupTools.BLACK)
  })
  bindClickHandler('switchSetupToolWhite', () => {
    player.switchSetupTool(setupTools.WHITE)
  })
  bindClickHandler('switchSetupToolClear', () => {
    player.switchSetupTool(setupTools.CLEAR)
  })

  //Handler for mode changes
  const onModeChange = () => {
    const mode = player.getActiveMode()
    toggleVisibility('replayTools', mode === playerModes.REPLAY)
    toggleVisibility('editTools', mode === playerModes.EDIT)
  }

  //Event handlers
  player.on('modeChanged', onModeChange)
  onModeChange()
</script>
</body>
</html>
